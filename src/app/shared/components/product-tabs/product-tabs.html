<section class="product-tabs-container flex flex-row-reverse gap-8">
  <div class="seller-card-wrapper">
    <app-seller-product-card
      [sellerName]="'ZULLO INDUSTRIES'"
      [rating]="4.8"
      [price]="5000000"
      [successfulPurchases]="500"
      [warrantyText]="'۷ روز تضمین بازگشت کالا'">
    </app-seller-product-card>
  </div>

  <section class="w-[77%]">
    <!-- Tab Navigation Menu -->
    <div class="tabs-menu">
      @for (tab of tabs; track tab.id) {
        <button
          class="tab-button"
          [ngClass]="{ 'active': activeTab === tab.id }"
          (click)="setActiveTab(tab.id)">
          {{ tab.label }}
        </button>
      }
    </div>

    <!-- Tab Content -->
    <div class="tabs-content">
      <!-- Specifications Tab -->
      <section id="specifications" class="tab-section">
        <div class="specifications-wrapper">
          <div class="specifications-content">
            <!-- Product Specifications Card -->
            <div class="info-card">
              <div class="info-card-title">
                <div class="card-header">
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 2L3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V7L10 2Z" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 2V7H17" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <h3 class="card-title">مشخصات کالا</h3>
                </div>
                <button class="view-more-btn">
                  <span>مشاهده بیشتر</span>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 12L3 7L4.41 5.59L8 9.17L11.59 5.59L13 7L8 12Z" fill="#0058CC"/>
                  </svg>
                </button>
              </div>
              <div class="card-content">
                @for (spec of specifications; track spec.label) {
                  <div class="info-row">
                    <span class="info-label">{{ spec.label }}:</span>
                    <span class="info-value">{{ spec.value }}</span>
                  </div>
                }
              </div>
            </div>

            <!-- Packaging Card -->
            <div class="info-card">
              <div class="card-header w-[25%]">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2 6L10 1L18 6V16C18 16.5304 17.7893 17.0391 17.4142 17.4142C17.0391 17.7893 16.5304 18 16 18H4C3.46957 18 2.96086 17.7893 2.58579 17.4142C2.21071 17.0391 2 16.5304 2 16V6Z" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M2 6L10 11L18 6" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M10 11V18" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h3 class="card-title">بسته‌بندی و ارسال</h3>
              </div>
              <div class="card-content">
                @for (info of packagingInfo; track info.label) {
                  <div class="info-row">
                    <span class="info-label">{{ info.label }}:</span>
                    <span class="info-value">{{ info.value }}</span>
                  </div>
                }
              </div>
            </div>

            <!-- Services Card -->
            <div class="info-card">
              <div class="card-header w-[25%]">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M10 2C11.1046 2 12 2.89543 12 4C12 5.10457 11.1046 6 10 6C8.89543 6 8 5.10457 8 4C8 2.89543 8.89543 2 10 2Z" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M10 8V18" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M4 12H16" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M6 16H14" stroke="#222222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h3 class="card-title">خدمات تأمین کننده / فروشنده</h3>
              </div>
              <div class="card-content">
                @for (service of servicesInfo; track service.label) {
                  <div class="info-row">
                    <span class="info-label">{{ service.label }}:</span>
                    <span class="info-value">{{ service.value }}</span>
                  </div>
                }
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- Reviews Tab -->
      <section id="reviews" class="tab-section">
        <div class="reviews-header-wrapper">
          <!-- Right Side: Rating and Button -->
          <div class="reviews-header-right">
            <h3 class="section-title">امتیاز و دیدگاه کاربران</h3>
            <p class="reviews-count">{{ reviewSummary.totalReviews }} دیدگاه برای این محصول ثبت شده است.</p>
            <div class="rating-summary">
              <div class="rating-display">
                <span class="rating-value">{{ reviewSummary.averageRating }}</span>
                <span class="rating-out-of">از ۵</span>
              </div>
              <div class="stars-display">
                @for (star of getStars(getRoundedRating(reviewSummary.averageRating)); track $index) {
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 15L4.5 18L5.5 11.5L1 7L7.5 6.5L10 0L12.5 6.5L19 7L14.5 11.5L15.5 18L10 15Z"
                          [attr.fill]="star === 1 ? '#FFAD16' : '#E5E5E5'"/>
                  </svg>
                }
              </div>
              <p class="votes-count">از مجموع {{ reviewSummary.totalVotes }} رای</p>
            </div>
            <p class="register-prompt">شما هم درباره این کالا دیدگاهتان را ثبت کنید</p>
            <button class="register-review-btn">ثبت دیدگاه</button>
          </div>

          <!-- Left Side: Summary Box -->
          <div class="reviews-summary-box">
            <h4 class="summary-title">خلاصه دیدگاه ها</h4>
            <p class="summary-text">{{ reviewSummary.summaryText }}</p>
            <div class="summary-sections">
              <div class="summary-section">
                <h5>نقاط قوت</h5>
                <ul>
                  @for (strength of reviewSummary.strengths; track strength) {
                    <li>{{ strength }}</li>
                  }
                </ul>
              </div>
              <div class="summary-section">
                <h5>نقاط ضعف</h5>
                <ul>
                  @for (weakness of reviewSummary.weaknesses; track weakness) {
                    <li>{{ weakness }}</li>
                  }
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Sort Options -->
        <div class="sort-options">
          <div class="sort-buttons">
            <span class="sort-label">ترتیب نمایش:</span>
            @for (option of reviewSortOptions; track option.id) {
              <button 
                class="sort-btn"
                [class.active]="selectedSortOption === option.id"
                (click)="selectedSortOption = option.id">
                {{ option.label }}
              </button>
            }
          </div>
        </div>

        <div class="reviews-list">
          @for (review of reviews; track review.id) {
            <div class="review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <span class="reviewer-name">{{ review.userName }}</span>
                  @if (review.isBuyer) {
                    <span class="buyer-badge">خریدار</span>
                  }
                  <span class="review-date">{{ review.date }}</span>
                </div>
                <div class="review-rating">
                  @for (star of getStars(review.rating); track $index) {
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8 0L10.5 5.5L16 6L12 9.5L13 16L8 12.5L3 16L4 9.5L0 6L5.5 5.5L8 0Z"
                            [attr.fill]="star === 1 ? '#FFAD16' : '#E5E5E5'"/>
                    </svg>
                  }
                </div>
              </div>
              <p class="review-text">{{ review.text }}</p>
              <div class="review-details">
                <div class="review-points">
                  <div class="points-section">
                    <strong>نقاط قوت:</strong>
                    <span>
                    @for (strength of review.strengths; track strength; let last = $last) {
                      {{ strength }}@if (!last) {، }
                    }
                  </span>
                  </div>
                  @if (review.weaknesses && review.weaknesses.length > 0) {
                    <div class="points-section">
                      <strong>نقاط ضعف:</strong>
                      <span>
                        @for (weakness of review.weaknesses; track weakness; let last = $last) {
                          {{ weakness }}@if (!last) {، }
                        }
                      </span>
                    </div>
                  }
                </div>
                <div class="review-seller">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 16V6L8 2L14 6V16H2Z" stroke="#666666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M6 16V10H10V16" stroke="#666666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 6H14" stroke="#666666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>{{ review.sellerName }}</span>
                </div>
              </div>
              <div class="review-actions">
                <button class="helpful-btn">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 0L10.5 5.5L16 6L12 9.5L13 16L8 12.5L3 16L4 9.5L0 6L5.5 5.5L8 0Z" fill="#009975"/>
                  </svg>
                  <span>{{ review.helpfulCount }}</span>
                </button>
                <button class="not-helpful-btn">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 16L5.5 10.5L0 10L4 6.5L3 0L8 3.5L13 0L12 6.5L16 10L10.5 10.5L8 16Z" fill="#999999"/>
                  </svg>
                  <span>{{ review.notHelpfulCount }}</span>
                </button>
                <button class="report-review-btn">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 0L10.5 5.5L16 6L12 9.5L13 16L8 12.5L3 16L4 9.5L0 6L5.5 5.5L8 0Z" fill="#999999"/>
                  </svg>
                  <span>گزارش دیدگاه</span>
                </button>
              </div>
            </div>
          }
        </div>
      </section>

      <!-- Questions Tab -->
      <section id="questions" class="tab-section">
        <div class="questions-header-wrapper">
          <div class="questions-header-right">
            <div class="section-title-wrapper">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 15L4.5 18L5.5 11.5L1 7L7.5 6.5L10 0L12.5 6.5L19 7L14.5 11.5L15.5 18L10 15Z" fill="#FFAD16"/>
              </svg>
              <h3 class="section-title">پرسش ها</h3>
            </div>
            <p class="questions-prompt">اگر پرسشی درباره این کالا دارید بپرسید.</p>
            <button class="register-question-btn">ثبت پرسش</button>
          </div>
          <div class="questions-sort">
            <div class="sort-buttons">
              <span class="sort-label">ترتیب نمایش:</span>
              @for (option of questionSortOptions; track option.id) {
                <button 
                  class="sort-btn"
                  [class.active]="selectedQuestionSort === option.id"
                  (click)="selectedQuestionSort = option.id">
                  {{ option.label }}
                </button>
              }
            </div>
          </div>
        </div>

        <div class="questions-list">
          @for (question of questions; track question.id) {
            <div class="question-item">
              <div class="question-header">
                <div class="questioner-info">
                  <div class="user-avatar">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="20" cy="20" r="20" fill="#E5E5E5"/>
                      <path d="M20 10C22.7614 10 25 12.2386 25 15C25 17.7614 22.7614 20 20 20C17.2386 20 15 17.7614 15 15C15 12.2386 17.2386 10 20 10Z" fill="#999999"/>
                      <path d="M12 28C12 24.6863 14.6863 22 18 22H22C25.3137 22 28 24.6863 28 28V30H12V28Z" fill="#999999"/>
                    </svg>
                  </div>
                  <div class="questioner-details">
                    <span class="questioner-name">{{ question.userName }}</span>
                    <span class="question-date">{{ question.date }}</span>
                  </div>
                </div>
                <button class="report-question-btn">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 0C8.55228 0 9 0.447715 9 1V7C9 7.55228 8.55228 8 8 8C7.44772 8 7 7.55228 7 7V1C7 0.447715 7.44772 0 8 0Z" fill="#999999"/>
                    <path d="M8 10C8.55228 10 9 10.4477 9 11V15C9 15.5523 8.55228 16 8 16C7.44772 16 7 15.5523 7 15V11C7 10.4477 7.44772 10 8 10Z" fill="#999999"/>
                  </svg>
                  <span>گزارش پرسش</span>
                </button>
              </div>
              <p class="question-text">{{ question.question }}</p>
              
              @if (question.answers && question.answers.length > 0) {
                <div class="answers-section">
                  @for (answer of question.answers; track answer.id) {
                    <div class="answer-item">
                      <div class="answer-header">
                        <div class="answerer-info">
                          <div class="user-avatar">
                            @if (answer.isOfficial) {
                              <div class="official-badge">
                                <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                  <circle cx="20" cy="20" r="20" fill="#009975"/>
                                  <path d="M20 10C22.7614 10 25 12.2386 25 15C25 17.7614 22.7614 20 20 20C17.2386 20 15 17.7614 15 15C15 12.2386 17.2386 10 20 10Z" fill="#FFFFFF"/>
                                </svg>
                              </div>
                            } @else {
                              <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="20" cy="20" r="20" fill="#E5E5E5"/>
                                <path d="M20 10C22.7614 10 25 12.2386 25 15C25 17.7614 22.7614 20 20 20C17.2386 20 15 17.7614 15 15C15 12.2386 17.2386 10 20 10Z" fill="#999999"/>
                                <path d="M12 28C12 24.6863 14.6863 22 18 22H22C25.3137 22 28 24.6863 28 28V30H12V28Z" fill="#999999"/>
                              </svg>
                            }
                          </div>
                          <div class="answerer-details">
                            <span class="answerer-name">{{ answer.userName }}</span>
                            <span class="answer-date">{{ answer.date }}</span>
                          </div>
                        </div>
                        <button class="report-answer-btn">
                          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 0C8.55228 0 9 0.447715 9 1V7C9 7.55228 8.55228 8 8 8C7.44772 8 7 7.55228 7 7V1C7 0.447715 7.44772 0 8 0Z" fill="#999999"/>
                            <path d="M8 10C8.55228 10 9 10.4477 9 11V15C9 15.5523 8.55228 16 8 16C7.44772 16 7 15.5523 7 15V11C7 10.4477 7.44772 10 8 10Z" fill="#999999"/>
                          </svg>
                          <span>گزارش پاسخ</span>
                        </button>
                      </div>
                      <p class="answer-text">{{ answer.text }}</p>
                      <div class="answer-helpful">
                        <p class="helpful-question">آیا این پاسخ مفید است؟</p>
                        <div class="answer-actions">
                          <button class="helpful-btn">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path d="M8 0L10.5 5.5L16 6L12 9.5L13 16L8 12.5L3 16L4 9.5L0 6L5.5 5.5L8 0Z" fill="#009975"/>
                            </svg>
                            <span>{{ answer.helpfulCount }}</span>
                          </button>
                          <button class="not-helpful-btn">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path d="M8 16L5.5 10.5L0 10L4 6.5L3 0L8 3.5L13 0L12 6.5L16 10L10.5 10.5L8 16Z" fill="#999999"/>
                            </svg>
                            <span>{{ answer.notHelpfulCount }}</span>
                          </button>
                        </div>
                      </div>
                    </div>
                  }
                </div>
              }
              
              <div class="answer-prompt">
                <span>برای این پرسش پاسخی دارید؟</span>
                <button class="submit-answer-link">
                  <span>ثبت پاسخ</span>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 8L13 8M13 8L10 5M13 8L10 11" stroke="#0058CC" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
            </div>
          }
        </div>

        <div class="view-more-questions">
          <button class="view-more-link">
            <span>مشاهده ۱۰ سوال دیگر</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 12L3 7L4.41 5.59L8 9.17L11.59 5.59L13 7L8 12Z" fill="#0058CC"/>
            </svg>
          </button>
        </div>
      </section>
    </div>
  </section>
</section>



